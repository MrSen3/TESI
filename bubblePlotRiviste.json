{
  "$schema": "https://vega.github.io/schema/vega-lite/v4.json",
  "data": {"name": "myData"},
  "name": "Bubble plot riviste",
  "id": "6",

  "title":{
    "text":"Bubble plot riviste",
    "offset": 15,
    "anchor": "middle",
    "orient": "top",
    "fontSize": 20,
    "fontWeight": "normal",
    "color": "#013378"

  },

  "transform": [
    {
      "aggregate": [
        {
          "op": "count",
          "as": "num_articoli"
        }
      ],
      "groupby": [
        "journal",
        "quartile",
        "anno"
      ]
    }
  ],

  "hconcat": [
    {
      "width": 650,
      "height": 750,

      "mark": {
    "type": "circle",
    "opacity": 0.8,
    "stroke": "black",
    "strokeWidth": 1,
    "fill": "#4682b4"
  },


  "encoding": {
    "x": {"field": "anno", "type": "ordinal", "axis":{"title":"Anno", "grid": true, "labels": true,
      "labelAngle": 0, "minExtent": 25
    }
    },
    "y": {"field": "journal", "type": "nominal", "axis":{"title":"Riviste", "minExtent":200, "grid":true}},
    "color": {
      "field": "quartile",
      "type": "nominal",
      "scale": {"range": ["#A4CF63", "#E8D559", "#FBA353", "#DD5A4E"]},
      "legend": null

    },
    "size": {
      "field": "num_articoli",
      "type": "quantitative",
      "legend": null,
      "scale": {"range": [0, 2000]}
    },

    "tooltip": [
      {"field": "journal","title": "Rivista", "type": "nominal"},
      {"field": "anno", "title": "Anno", "type": "nominal"},
      {"field": "num_articoli", "title": "Pubblicazioni", "type": "quantitative"},
      {"field": "quartile", "title": "Quartile", "type": "ordinal"}
    ]
  },
      "transform": [{"filter": {"selection": "legend"}}]
},
    {
      "width": 40,
      "height": 100,
      "mark": {"type": "circle",
      "size": 85},
      "encoding": {
        "tooltip": null,
        "color": {
          "condition": {
            "type": "nominal",
            "field": "quartile",
            "legend": null,
            "selection": "legend"
          },
          "value": "lightgray"
        },
        "y": {
          "type": "nominal",
          "field": "quartile",
          "title": null,
          "axis": {
            "orient": "right",
            "minExtent": 100,
            "labels": true
          }
        }
      },
      "selection": {
        "legend": {
          "type": "multi",
          "encodings": [
            "color"
          ],
          "on": "click",
          "toggle": "true",
          "resolve": "global",
          "empty": "all"
        }
      }
    }

  ]}